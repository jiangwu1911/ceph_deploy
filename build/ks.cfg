# Kickstart file automatically generated by anaconda.

#version=DEVEL
text
cdrom
lang zh_CN.UTF-8
keyboard us
timezone --utc Asia/Shanghai
auth --useshadow --enablemd5
selinux --disabled
firewall --disabled
services --enabled=NetworkManager,sshd
ignoredisk --only-use=sda
bootloader --location=mbr
zerombr
clearpart --all --initlabel
part swap --asprimary --fstype="swap" --size=1024
part /boot --fstype ext4 --size=200
part pv.01 --size=1 --grow
volgroup rootvg01 pv.01
logvol / --fstype ext4 --name=lv01 --vgname=rootvg01 --size=1 --grow

# Default root password is 'zhu88jie'
rootpw --iscrypted $6$fdNtm1rb$7jNf0MwE4Wal2r2uDyn.LB7iZAkE.YMrbCADWjl4uffBRJo4k0Yhn4DlHZ7wgkFlv.ITgPXpMELP5qzfgy9yd0
network --bootproto=static --ip=172.16.10.3 --netmask=255.255.255.0 --gateway=172.16.10.2 --nameserver=172.16.10.2 --hostname=admin

%packages --nobase
@core
@cobbler
@fbterm
@mysql
%end

%post
mkdir -p /tmp/cdrom
mount /dev/cdrom /tmp/cdrom
cp -r /tmp/cdrom/software /root
cp /tmp/cdrom/packages/fbterm/Monaco_Linux.ttf /usr/share/fonts
fc-cache -fv
umount /tmp/cdrom
rm -f /tmp/cdrom

sed -i "s/^hosts:.*/hosts: files/" /etc/nsswitch.conf
sed -i "s/ quiet/ quiet vga=0x0317/" /boot/grub/grub.conf

echo "ENABLED=0" > /etc/sysconfig/bootstrap_admin_node
cp /root/software/cobbler/bootstrap_admin_node.conf /etc/init
cp /root/software/cobbler/configuration.sh /root

cat >> /root/.bash_profile <<EOF
if [ "\$TERM" = "linux" ]; then  
    alias fbterm='LANG=zh_CN.UTF-8 fbterm'  
    fbterm -s 14 -n Monaco
fi
EOF
%end

bootloader
reboot
